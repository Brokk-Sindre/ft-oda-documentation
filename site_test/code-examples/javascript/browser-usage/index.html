<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>JavaScript Browser Usage - Test</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Test</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#javascript-browser-usage" class="nav-link">JavaScript Browser Usage</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#overview" class="nav-link">Overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#browser-compatibility" class="nav-link">Browser Compatibility</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#basic-browser-setup" class="nav-link">Basic Browser Setup</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#cors-configuration" class="nav-link">CORS Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#error-handling-in-browsers" class="nav-link">Error Handling in Browsers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#progressive-web-app-pwa-example" class="nav-link">Progressive Web App (PWA) Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#performance-optimization-for-browsers" class="nav-link">Performance Optimization for Browsers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#mobile-responsive-patterns" class="nav-link">Mobile-Responsive Patterns</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="javascript-browser-usage">JavaScript Browser Usage</h1>
<p>Complete guide for using the Danish Parliament API in web browsers with CORS handling, modern JavaScript, and interactive examples.</p>
<h2 id="overview">Overview</h2>
<p>The Danish Parliament API supports <strong>CORS (Cross-Origin Resource Sharing)</strong>, making it directly accessible from web browsers without a backend proxy. This enables powerful client-side applications for parliamentary data visualization and analysis.</p>
<h2 id="browser-compatibility">Browser Compatibility</h2>
<ul>
<li><strong>Modern browsers</strong>: Chrome 42+, Firefox 39+, Safari 10.1+, Edge 14+</li>
<li><strong>Native fetch API</strong>: No external dependencies required</li>
<li><strong>ES6+ features</strong>: Async/await, classes, modules</li>
<li><strong>CORS enabled</strong>: Direct API access from any domain</li>
</ul>
<h2 id="basic-browser-setup">Basic Browser Setup</h2>
<h3 id="1-html-structure">1. HTML Structure</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Danish Parliament API Browser Demo&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #d32f2f;
            background: #ffebee;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            color: #388e3c;
            background: #e8f5e8;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .case-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #fafafa;
        }
        .case-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 5px;
        }
        .case-meta {
            font-size: 0.9em;
            color: #666;
        }
        .controls {
            margin: 20px 0;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
        }
        .controls input, .controls button {
            margin: 5px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .controls button {
            background: #1976d2;
            color: white;
            cursor: pointer;
        }
        .controls button:hover {
            background: #1565c0;
        }
        #progressBar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        #progressFill {
            height: 100%;
            background: #4caf50;
            width: 0%;
            transition: width 0.3s ease;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Danish Parliament API Browser Demo&lt;/h1&gt;

    &lt;div class=&quot;controls&quot;&gt;
        &lt;h3&gt;Search Parliamentary Cases&lt;/h3&gt;
        &lt;input type=&quot;text&quot; id=&quot;searchTerm&quot; placeholder=&quot;Search term (e.g., 'klima')&quot; value=&quot;klima&quot;&gt;
        &lt;input type=&quot;number&quot; id=&quot;maxResults&quot; placeholder=&quot;Max results&quot; value=&quot;20&quot; min=&quot;1&quot; max=&quot;100&quot;&gt;
        &lt;button onclick=&quot;searchCases()&quot;&gt;Search Cases&lt;/button&gt;
        &lt;button onclick=&quot;getRecentActivity()&quot;&gt;Get Recent Activity&lt;/button&gt;
        &lt;button onclick=&quot;clearResults()&quot;&gt;Clear Results&lt;/button&gt;
    &lt;/div&gt;

    &lt;div id=&quot;status&quot; class=&quot;loading&quot; style=&quot;display: none;&quot;&gt;Loading...&lt;/div&gt;
    &lt;div id=&quot;progressBar&quot; style=&quot;display: none;&quot;&gt;
        &lt;div id=&quot;progressFill&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div id=&quot;results&quot;&gt;&lt;/div&gt;

    &lt;script type=&quot;module&quot;&gt;
        // Import the API client (assuming it's in the same directory)
        import { DanishParliamentAPI } from './danish-parliament-api.js';

        // Initialize the API client
        const api = new DanishParliamentAPI({
            requestDelay: 200 // Be extra respectful in browsers
        });

        // Make functions globally available
        window.api = api;
        window.searchCases = searchCases;
        window.getRecentActivity = getRecentActivity;
        window.clearResults = clearResults;

        // Search function
        async function searchCases() {
            const searchTerm = document.getElementById('searchTerm').value.trim();
            const maxResults = parseInt(document.getElementById('maxResults').value) || 20;

            if (!searchTerm) {
                showError('Please enter a search term');
                return;
            }

            showStatus('Searching for cases...');
            showProgress(0);

            try {
                // Search for cases
                const response = await api.getCases({
                    filter: `substringof('${searchTerm}', titel)`,
                    top: Math.min(maxResults, 100),
                    orderby: 'opdateringsdato desc'
                });

                showProgress(100);
                displayCases(response.value, `Search results for &quot;${searchTerm}&quot;`);
                showSuccess(`Found ${response.value.length} cases`);

            } catch (error) {
                showError(`Search failed: ${error.message}`);
                hideProgress();
            }
        }

        // Get recent activity
        async function getRecentActivity() {
            showStatus('Fetching recent parliamentary activity...');
            showProgress(0);

            try {
                const response = await api.getRecentChanges('Sag', 24); // Last 24 hours

                showProgress(100);
                displayCases(response.value, 'Recent Parliamentary Activity (Last 24 hours)');
                showSuccess(`Found ${response.value.length} recently updated cases`);

            } catch (error) {
                showError(`Failed to fetch recent activity: ${error.message}`);
                hideProgress();
            }
        }

        // Display cases in the UI
        function displayCases(cases, title) {
            const resultsDiv = document.getElementById('results');

            if (cases.length === 0) {
                resultsDiv.innerHTML = `&lt;div class=&quot;error&quot;&gt;No cases found&lt;/div&gt;`;
                return;
            }

            let html = `&lt;h2&gt;${title}&lt;/h2&gt;`;

            cases.forEach(case =&gt; {
                const updatedDate = new Date(case.opdateringsdato).toLocaleDateString('da-DK');
                html += `
                    &lt;div class=&quot;case-card&quot;&gt;
                        &lt;div class=&quot;case-title&quot;&gt;${case.titel}&lt;/div&gt;
                        &lt;div class=&quot;case-meta&quot;&gt;
                            ID: ${case.id} | 
                            Updated: ${updatedDate} | 
                            Type: ${case.typeid}
                        &lt;/div&gt;
                    &lt;/div&gt;
                `;
            });

            resultsDiv.innerHTML = html;
            hideStatus();
        }

        // UI helper functions
        function showStatus(message) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            statusDiv.className = 'loading';
        }

        function showSuccess(message) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            statusDiv.className = 'success';
            setTimeout(() =&gt; hideStatus(), 3000);
        }

        function showError(message) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            statusDiv.className = 'error';
        }

        function hideStatus() {
            document.getElementById('status').style.display = 'none';
        }

        function showProgress(percentage) {
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');

            progressBar.style.display = 'block';
            progressFill.style.width = percentage + '%';
        }

        function hideProgress() {
            document.getElementById('progressBar').style.display = 'none';
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            hideStatus();
            hideProgress();
        }

        // Initialize with a sample search on page load
        window.addEventListener('load', () =&gt; {
            console.log('Danish Parliament API Browser Demo loaded');
            console.log('Try searching for &quot;klima&quot; to see climate-related legislation');
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="2-advanced-interactive-dashboard">2. Advanced Interactive Dashboard</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Parliamentary Dashboard&lt;/title&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;&gt;&lt;/script&gt;
    &lt;style&gt;
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .widget {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .widget h3 {
            margin: 0 0 15px 0;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #1976d2;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1976d2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Danish Parliament Live Dashboard&lt;/h1&gt;

    &lt;div class=&quot;dashboard&quot;&gt;
        &lt;!-- Statistics Widget --&gt;
        &lt;div class=&quot;widget&quot;&gt;
            &lt;h3&gt;=ÃŠ Parliamentary Statistics&lt;/h3&gt;
            &lt;div id=&quot;statsLoader&quot; class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;
            &lt;div id=&quot;statsContent&quot; style=&quot;display: none;&quot;&gt;
                &lt;div class=&quot;stat-grid&quot;&gt;
                    &lt;div class=&quot;stat-item&quot;&gt;
                        &lt;div class=&quot;stat-number&quot; id=&quot;totalCases&quot;&gt;-&lt;/div&gt;
                        &lt;div class=&quot;stat-label&quot;&gt;Total Cases&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;stat-item&quot;&gt;
                        &lt;div class=&quot;stat-number&quot; id=&quot;totalActors&quot;&gt;-&lt;/div&gt;
                        &lt;div class=&quot;stat-label&quot;&gt;Total Actors&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;stat-item&quot;&gt;
                        &lt;div class=&quot;stat-number&quot; id=&quot;recentUpdates&quot;&gt;-&lt;/div&gt;
                        &lt;div class=&quot;stat-label&quot;&gt;Updates Today&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;stat-item&quot;&gt;
                        &lt;div class=&quot;stat-number&quot; id=&quot;apiResponseTime&quot;&gt;-&lt;/div&gt;
                        &lt;div class=&quot;stat-label&quot;&gt;API Response (ms)&lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- Recent Activity Widget --&gt;
        &lt;div class=&quot;widget&quot;&gt;
            &lt;h3&gt;Â¡ Recent Activity&lt;/h3&gt;
            &lt;div id=&quot;recentLoader&quot; class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;
            &lt;div id=&quot;recentActivity&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- Topic Analysis Widget --&gt;
        &lt;div class=&quot;widget&quot;&gt;
            &lt;h3&gt;&lt;Ã· Topic Analysis&lt;/h3&gt;
            &lt;div id=&quot;topicsLoader&quot; class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;
            &lt;div class=&quot;chart-container&quot;&gt;
                &lt;canvas id=&quot;topicsChart&quot; style=&quot;display: none;&quot;&gt;&lt;/canvas&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- Real-time Monitor Widget --&gt;
        &lt;div class=&quot;widget&quot;&gt;
            &lt;h3&gt;=4 Live Monitor&lt;/h3&gt;
            &lt;button id=&quot;startMonitoring&quot; onclick=&quot;toggleMonitoring()&quot;&gt;Start Monitoring&lt;/button&gt;
            &lt;div id=&quot;monitorStatus&quot; style=&quot;margin-top: 10px;&quot;&gt;&lt;/div&gt;
            &lt;div id=&quot;liveUpdates&quot; style=&quot;max-height: 300px; overflow-y: auto; margin-top: 15px;&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;script type=&quot;module&quot;&gt;
        import { DanishParliamentAPI } from './danish-parliament-api.js';

        const api = new DanishParliamentAPI({ requestDelay: 300 });
        let monitoringInterval = null;
        let isMonitoring = false;

        // Initialize dashboard
        async function initializeDashboard() {
            await loadStatistics();
            await loadRecentActivity();
            await loadTopicAnalysis();
        }

        // Load basic statistics
        async function loadStatistics() {
            try {
                const startTime = Date.now();

                // Get counts for major entities
                const [caseCount, actorCount, recentChanges] = await Promise.all([
                    api.getEntityCount('Sag'),
                    api.getEntityCount('AktÃ¸r'),
                    api.getRecentChanges('Sag', 24)
                ]);

                const responseTime = Date.now() - startTime;

                // Update UI
                document.getElementById('totalCases').textContent = caseCount.toLocaleString();
                document.getElementById('totalActors').textContent = actorCount.toLocaleString();
                document.getElementById('recentUpdates').textContent = recentChanges.value.length;
                document.getElementById('apiResponseTime').textContent = responseTime;

                // Show content, hide loader
                document.getElementById('statsLoader').style.display = 'none';
                document.getElementById('statsContent').style.display = 'block';

            } catch (error) {
                console.error('Failed to load statistics:', error);
                document.getElementById('statsLoader').innerHTML = '&lt;div style=&quot;color: red;&quot;&gt;Failed to load&lt;/div&gt;';
            }
        }

        // Load recent activity
        async function loadRecentActivity() {
            try {
                const recent = await api.getRecentChanges('Sag', 6); // Last 6 hours
                const activityDiv = document.getElementById('recentActivity');

                if (recent.value.length === 0) {
                    activityDiv.innerHTML = '&lt;p&gt;No recent activity&lt;/p&gt;';
                } else {
                    let html = '';
                    recent.value.slice(0, 5).forEach(case =&gt; {
                        const timeAgo = getTimeAgo(new Date(case.opdateringsdato));
                        html += `
                            &lt;div style=&quot;padding: 10px; margin: 5px 0; background: #f8f9fa; border-radius: 6px;&quot;&gt;
                                &lt;strong&gt;${case.titel.substring(0, 60)}${case.titel.length &gt; 60 ? '...' : ''}&lt;/strong&gt;&lt;br&gt;
                                &lt;small style=&quot;color: #666;&quot;&gt;Updated ${timeAgo}&lt;/small&gt;
                            &lt;/div&gt;
                        `;
                    });
                    activityDiv.innerHTML = html;
                }

                document.getElementById('recentLoader').style.display = 'none';
                activityDiv.style.display = 'block';

            } catch (error) {
                console.error('Failed to load recent activity:', error);
                document.getElementById('recentLoader').innerHTML = '&lt;div style=&quot;color: red;&quot;&gt;Failed to load&lt;/div&gt;';
            }
        }

        // Load topic analysis
        async function loadTopicAnalysis() {
            try {
                // Search for common topics
                const topics = ['klima', 'miljÃ¸', 'Ã¸konomi', 'sundhed', 'uddannelse'];
                const results = await Promise.all(
                    topics.map(async topic =&gt; {
                        const response = await api.getCases({
                            filter: `substringof('${topic}', titel)`,
                            top: 1
                        });
                        // Get count from a separate query
                        const countResponse = await api.request('Sag', {
                            '$filter': `substringof('${topic}', titel)`,
                            '$inlinecount': 'allpages',
                            '$top': 1
                        });
                        return {
                            topic: topic,
                            count: parseInt(countResponse['odata.count'] || 0)
                        };
                    })
                );

                // Create chart
                const ctx = document.getElementById('topicsChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: results.map(r =&gt; r.topic.charAt(0).toUpperCase() + r.topic.slice(1)),
                        datasets: [{
                            label: 'Number of Cases',
                            data: results.map(r =&gt; r.count),
                            backgroundColor: [
                                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Cases by Topic'
                            }
                        }
                    }
                });

                document.getElementById('topicsLoader').style.display = 'none';
                document.getElementById('topicsChart').style.display = 'block';

            } catch (error) {
                console.error('Failed to load topic analysis:', error);
                document.getElementById('topicsLoader').innerHTML = '&lt;div style=&quot;color: red;&quot;&gt;Failed to load&lt;/div&gt;';
            }
        }

        // Real-time monitoring
        window.toggleMonitoring = function() {
            if (isMonitoring) {
                stopMonitoring();
            } else {
                startMonitoring();
            }
        };

        function startMonitoring() {
            isMonitoring = true;
            document.getElementById('startMonitoring').textContent = 'Stop Monitoring';
            document.getElementById('monitorStatus').innerHTML = '&lt;span style=&quot;color: green;&quot;&gt;=Ã¢ Monitoring active&lt;/span&gt;';

            // Check for updates every 30 seconds
            monitoringInterval = setInterval(checkForUpdates, 30000);
            checkForUpdates(); // Initial check
        }

        function stopMonitoring() {
            isMonitoring = false;
            document.getElementById('startMonitoring').textContent = 'Start Monitoring';
            document.getElementById('monitorStatus').innerHTML = '&lt;span style=&quot;color: #666;&quot;&gt;Âª Monitoring stopped&lt;/span&gt;';

            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                monitoringInterval = null;
            }
        }

        async function checkForUpdates() {
            try {
                // Check for updates in the last 5 minutes
                const cutoffTime = new Date();
                cutoffTime.setMinutes(cutoffTime.getMinutes() - 5);
                const isoTime = cutoffTime.toISOString().slice(0, 19);

                const updates = await api.request('Sag', {
                    '$filter': `opdateringsdato gt datetime'${isoTime}'`,
                    '$orderby': 'opdateringsdato desc',
                    '$top': 10
                });

                const updatesDiv = document.getElementById('liveUpdates');

                if (updates.value &amp;&amp; updates.value.length &gt; 0) {
                    let html = '';
                    updates.value.forEach(case =&gt; {
                        const timeAgo = getTimeAgo(new Date(case.opdateringsdato));
                        html += `
                            &lt;div style=&quot;padding: 8px; margin: 3px 0; background: #e8f5e8; border-radius: 4px; border-left: 4px solid #4caf50;&quot;&gt;
                                &lt;strong&gt;New Update:&lt;/strong&gt; ${case.titel.substring(0, 50)}...&lt;br&gt;
                                &lt;small style=&quot;color: #666;&quot;&gt;${timeAgo}&lt;/small&gt;
                            &lt;/div&gt;
                        `;
                    });

                    updatesDiv.innerHTML = html + updatesDiv.innerHTML;

                    // Limit to 20 updates
                    const children = updatesDiv.children;
                    while (children.length &gt; 20) {
                        updatesDiv.removeChild(children[children.length - 1]);
                    }
                } else {
                    // Add a &quot;no updates&quot; message occasionally
                    if (Math.random() &lt; 0.2) { // 20% chance
                        const now = new Date().toLocaleTimeString();
                        updatesDiv.innerHTML = `
                            &lt;div style=&quot;padding: 8px; margin: 3px 0; background: #f0f0f0; border-radius: 4px; color: #666;&quot;&gt;
                                No new updates (checked at ${now})
                            &lt;/div&gt;
                        ` + updatesDiv.innerHTML;
                    }
                }

            } catch (error) {
                console.error('Error checking for updates:', error);
                document.getElementById('monitorStatus').innerHTML = '&lt;span style=&quot;color: red;&quot;&gt;L Monitor error&lt;/span&gt;';
            }
        }

        // Utility function to calculate time ago
        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);

            if (diffInSeconds &lt; 60) return `${diffInSeconds} seconds ago`;
            if (diffInSeconds &lt; 3600) return `${Math.floor(diffInSeconds / 60)} minutes ago`;
            if (diffInSeconds &lt; 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            return `${Math.floor(diffInSeconds / 86400)} days ago`;
        }

        // Initialize dashboard when page loads
        window.addEventListener('load', () =&gt; {
            console.log('Parliamentary Dashboard initializing...');
            initializeDashboard();
        });

    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="cors-configuration">CORS Configuration</h2>
<p>The Danish Parliament API correctly supports CORS:</p>
<pre><code class="language-javascript">// These headers are returned by the API:
// Access-Control-Allow-Origin: *
// Access-Control-Allow-Methods: GET,POST,PUT,PATCH,MERGE,DELETE
// Access-Control-Allow-Headers: Content-Type

// This means you can make direct requests from any domain
const response = await fetch('https://oda.ft.dk/api/Sag?%24top=5');
const data = await response.json();
</code></pre>
<h2 id="error-handling-in-browsers">Error Handling in Browsers</h2>
<pre><code class="language-javascript">// Browser-specific error handling
class BrowserAPIError extends Error {
    constructor(message, type = 'UNKNOWN') {
        super(message);
        this.name = 'BrowserAPIError';
        this.type = type;
        this.timestamp = new Date().toISOString();
    }

    // Display error in user-friendly way
    displayToUser(containerId) {
        const container = document.getElementById(containerId);
        if (container) {
            container.innerHTML = `
                &lt;div class=&quot;error-message&quot; style=&quot;
                    background: #ffebee; 
                    color: #c62828; 
                    padding: 15px; 
                    border-radius: 8px; 
                    margin: 10px 0;
                    border-left: 4px solid #d32f2f;
                &quot;&gt;
                    &lt;strong&gt;Error:&lt;/strong&gt; ${this.message}&lt;br&gt;
                    &lt;small&gt;Time: ${new Date(this.timestamp).toLocaleString()}&lt;/small&gt;
                &lt;/div&gt;
            `;
        }
    }
}

// Enhanced error handling for browser environment
async function safeAPICall(apiCall, errorContainerId = null) {
    try {
        return await apiCall();
    } catch (error) {
        let browserError;

        if (error.name === 'TypeError' &amp;&amp; error.message.includes('fetch')) {
            browserError = new BrowserAPIError(
                'Network connection failed. Please check your internet connection.',
                'NETWORK_ERROR'
            );
        } else if (error.name === 'AbortError') {
            browserError = new BrowserAPIError(
                'Request took too long and was cancelled.',
                'TIMEOUT_ERROR'
            );
        } else if (error.message.includes('CORS')) {
            browserError = new BrowserAPIError(
                'Cross-origin request blocked. This should not happen with the Danish Parliament API.',
                'CORS_ERROR'
            );
        } else {
            browserError = new BrowserAPIError(error.message, 'API_ERROR');
        }

        // Log for debugging
        console.error('API Error:', browserError);

        // Display to user if container provided
        if (errorContainerId) {
            browserError.displayToUser(errorContainerId);
        }

        throw browserError;
    }
}

// Usage example
async function searchWithErrorHandling() {
    await safeAPICall(
        () =&gt; api.getCases({ filter: &quot;substringof('klima', titel)&quot; }),
        'errorContainer'
    );
}
</code></pre>
<h2 id="progressive-web-app-pwa-example">Progressive Web App (PWA) Example</h2>
<pre><code class="language-javascript">// Service Worker for offline functionality (sw.js)
const CACHE_NAME = 'parliament-api-v1';
const CACHE_URLS = [
    '/',
    '/index.html',
    '/danish-parliament-api.js',
    'https://cdn.jsdelivr.net/npm/chart.js'
];

// Install event - cache resources
self.addEventListener('install', event =&gt; {
    event.waitUntil(
        caches.open(CACHE_NAME)
            .then(cache =&gt; cache.addAll(CACHE_URLS))
    );
});

// Fetch event - serve from cache when offline
self.addEventListener('fetch', event =&gt; {
    // Only cache GET requests to our domain or the API
    if (event.request.method === 'GET' &amp;&amp; 
        (event.request.url.includes(location.origin) || 
         event.request.url.includes('oda.ft.dk'))) {

        event.respondWith(
            caches.match(event.request)
                .then(response =&gt; {
                    // Return cached version or fetch from network
                    return response || fetch(event.request).then(fetchResponse =&gt; {
                        // Cache successful API responses
                        if (fetchResponse.status === 200) {
                            const responseClone = fetchResponse.clone();
                            caches.open(CACHE_NAME)
                                .then(cache =&gt; cache.put(event.request, responseClone));
                        }
                        return fetchResponse;
                    });
                })
                .catch(() =&gt; {
                    // Return offline page or cached data
                    return caches.match('/offline.html');
                })
        );
    }
});
</code></pre>
<pre><code class="language-html">&lt;!-- PWA Manifest (manifest.json) --&gt;
{
    &quot;name&quot;: &quot;Danish Parliament Dashboard&quot;,
    &quot;short_name&quot;: &quot;Parliament&quot;,
    &quot;description&quot;: &quot;Real-time Danish Parliament data dashboard&quot;,
    &quot;start_url&quot;: &quot;/&quot;,
    &quot;display&quot;: &quot;standalone&quot;,
    &quot;background_color&quot;: &quot;#ffffff&quot;,
    &quot;theme_color&quot;: &quot;#1976d2&quot;,
    &quot;icons&quot;: [
        {
            &quot;src&quot;: &quot;icon-192.png&quot;,
            &quot;sizes&quot;: &quot;192x192&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        },
        {
            &quot;src&quot;: &quot;icon-512.png&quot;,
            &quot;sizes&quot;: &quot;512x512&quot;,
            &quot;type&quot;: &quot;image/png&quot;
        }
    ]
}

&lt;!-- In HTML head --&gt;
&lt;link rel=&quot;manifest&quot; href=&quot;manifest.json&quot;&gt;
&lt;meta name=&quot;theme-color&quot; content=&quot;#1976d2&quot;&gt;

&lt;!-- Register service worker --&gt;
&lt;script&gt;
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
        .then(registration =&gt; console.log('SW registered'))
        .catch(error =&gt; console.log('SW registration failed'));
}
&lt;/script&gt;
</code></pre>
<h2 id="performance-optimization-for-browsers">Performance Optimization for Browsers</h2>
<h3 id="1-request-batching">1. Request Batching</h3>
<pre><code class="language-javascript">class RequestBatcher {
    constructor(api, batchDelay = 100) {
        this.api = api;
        this.batchDelay = batchDelay;
        this.queue = [];
        this.timeoutId = null;
    }

    // Add request to batch
    addRequest(entity, params) {
        return new Promise((resolve, reject) =&gt; {
            this.queue.push({ entity, params, resolve, reject });

            // Start batch timer if not already running
            if (!this.timeoutId) {
                this.timeoutId = setTimeout(() =&gt; this.processBatch(), this.batchDelay);
            }
        });
    }

    // Process all queued requests
    async processBatch() {
        const currentQueue = [...this.queue];
        this.queue = [];
        this.timeoutId = null;

        // Group similar requests
        const grouped = {};
        currentQueue.forEach(req =&gt; {
            const key = `${req.entity}_${JSON.stringify(req.params)}`;
            if (!grouped[key]) {
                grouped[key] = [];
            }
            grouped[key].push(req);
        });

        // Execute unique requests
        for (const [key, requests] of Object.entries(grouped)) {
            const firstReq = requests[0];

            try {
                const result = await this.api.request(firstReq.entity, firstReq.params);

                // Resolve all similar requests with same result
                requests.forEach(req =&gt; req.resolve(result));

            } catch (error) {
                // Reject all similar requests
                requests.forEach(req =&gt; req.reject(error));
            }
        }
    }
}

// Usage
const api = new DanishParliamentAPI();
const batcher = new RequestBatcher(api);

// These will be batched together
const results = await Promise.all([
    batcher.addRequest('Sag', { '$top': 10 }),
    batcher.addRequest('Sag', { '$top': 10 }), // Duplicate - will reuse result
    batcher.addRequest('AktÃ¸r', { '$top': 5 })
]);
</code></pre>
<h3 id="2-caching-strategy">2. Caching Strategy</h3>
<pre><code class="language-javascript">class CachedAPI {
    constructor(api, cacheDuration = 300000) { // 5 minutes default
        this.api = api;
        this.cacheDuration = cacheDuration;
        this.cache = new Map();
    }

    // Generate cache key
    getCacheKey(entity, params) {
        return `${entity}_${JSON.stringify(params)}`;
    }

    // Check if cache entry is valid
    isValidCache(entry) {
        return Date.now() - entry.timestamp &lt; this.cacheDuration;
    }

    // Cached request
    async request(entity, params) {
        const key = this.getCacheKey(entity, params);
        const cached = this.cache.get(key);

        // Return cached result if valid
        if (cached &amp;&amp; this.isValidCache(cached)) {
            console.log('Cache hit:', key);
            return cached.data;
        }

        // Fetch from API
        try {
            const result = await this.api.request(entity, params);

            // Cache the result
            this.cache.set(key, {
                data: result,
                timestamp: Date.now()
            });

            console.log('Cache miss:', key);
            return result;

        } catch (error) {
            // Return stale cache if available
            if (cached) {
                console.log('Using stale cache due to error:', key);
                return cached.data;
            }
            throw error;
        }
    }

    // Clear expired cache entries
    cleanupCache() {
        for (const [key, entry] of this.cache.entries()) {
            if (!this.isValidCache(entry)) {
                this.cache.delete(key);
            }
        }
    }
}

// Usage
const api = new DanishParliamentAPI();
const cachedApi = new CachedAPI(api);

// Clean up cache every 10 minutes
setInterval(() =&gt; cachedApi.cleanupCache(), 600000);
</code></pre>
<h2 id="mobile-responsive-patterns">Mobile-Responsive Patterns</h2>
<pre><code class="language-css">/* Mobile-first responsive design */
@media (max-width: 768px) {
    .dashboard {
        grid-template-columns: 1fr;
        padding: 10px;
    }

    .widget {
        padding: 15px;
    }

    .stat-grid {
        grid-template-columns: 1fr;
    }

    .controls input,
    .controls button {
        width: 100%;
        box-sizing: border-box;
        margin: 5px 0;
    }
}

/* Touch-friendly buttons */
.controls button {
    min-height: 44px; /* iOS minimum touch target */
    min-width: 44px;
}
</code></pre>
<pre><code class="language-javascript">// Mobile-specific optimizations
class MobileOptimizedAPI extends DanishParliamentAPI {
    constructor(options = {}) {
        super({
            ...options,
            // Longer timeout for mobile networks
            timeout: 45000,
            // More aggressive rate limiting
            requestDelay: 500
        });

        this.isMobile = this.detectMobile();
    }

    detectMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i
            .test(navigator.userAgent);
    }

    // Mobile-optimized pagination (smaller batches)
    async* paginateAll(entity, options = {}) {
        const mobileOptions = {
            ...options,
            batchSize: this.isMobile ? 20 : (options.batchSize || 100)
        };

        yield* super.paginateAll(entity, mobileOptions);
    }
}
</code></pre>
<p>This comprehensive browser usage guide provides everything needed to build powerful client-side applications with the Danish Parliament API, from simple demos to full-featured progressive web apps.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
