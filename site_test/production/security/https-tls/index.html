<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>HTTPS and TLS Configuration - Test</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Test</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#https-and-tls-configuration" class="nav-link">HTTPS and TLS Configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#tls-configuration-analysis" class="nav-link">TLS Configuration Analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#client-configuration" class="nav-link">Client Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#certificate-management" class="nav-link">Certificate Management</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#troubleshooting-tls-issues" class="nav-link">Troubleshooting TLS Issues</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#best-practices-summary" class="nav-link">Best Practices Summary</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="https-and-tls-configuration">HTTPS and TLS Configuration</h1>
<p>The Danish Parliament API implements strong TLS encryption to protect data in transit. This guide covers TLS configuration details, certificate management, and client-side implementation best practices.</p>
<h2 id="tls-configuration-analysis">TLS Configuration Analysis</h2>
<h3 id="current-tls-setup">Current TLS Setup</h3>
<p>Based on comprehensive security testing (Phase 15 investigation), the API uses:</p>
<pre><code>TLS Version: 1.2
Cipher Suite: ECDHE-RSA-AES256-SHA384
Certificate Authority: GlobalSign RSA OV SSL CA 2018
Certificate Validity: Until August 3, 2026
Wildcard Coverage: *.ft.dk (covers oda.ft.dk)
</code></pre>
<h3 id="certificate-details">Certificate Details</h3>
<pre><code class="language-bash"># Verify current certificate status
curl -I -v &quot;https://oda.ft.dk/api/Sag&quot; 2&gt;&amp;1 | grep -E &quot;(SSL|TLS|Certificate)&quot;

# Expected output:
# * TLSv1.2 (OUT), TLS handshake, Client hello (1):
# * TLSv1.2 (IN), TLS handshake, Server hello (2):
# * TLSv1.2 (IN), TLS handshake, Certificate (11):
# * SSL certificate verify ok.
</code></pre>
<h3 id="security-strength-assessment">Security Strength Assessment</h3>
<p><strong>Strengths:</strong>
-  Strong cipher suite (AES-256, SHA-384)
-  Forward secrecy (ECDHE key exchange)
-  Valid certificate chain
-  Wildcard certificate properly configured
-  Certificate from trusted CA (GlobalSign)</p>
<p><strong>Limitations:</strong>
- Â  No HTTP/2 support (uses HTTP/1.1)
- Â  Missing security headers (HSTS, CSP)
- Â  Aggressive no-cache policies (no ETag support)</p>
<h2 id="client-configuration">Client Configuration</h2>
<h3 id="python-implementation">Python Implementation</h3>
<pre><code class="language-python">import requests
import ssl
import urllib3
from requests.adapters import HTTPAdapter

class SecureDanishParliamentClient:
    def __init__(self):
        self.session = requests.Session()
        self.base_url = &quot;https://oda.ft.dk/api&quot;
        self._configure_tls()

    def _configure_tls(self):
        &quot;&quot;&quot;Configure secure TLS settings&quot;&quot;&quot;
        # Create SSL context with strong security
        ssl_context = ssl.create_default_context()
        ssl_context.check_hostname = True
        ssl_context.verify_mode = ssl.CERT_REQUIRED

        # Disable weak protocols
        ssl_context.options |= ssl.OP_NO_SSLv2
        ssl_context.options |= ssl.OP_NO_SSLv3
        ssl_context.options |= ssl.OP_NO_TLSv1
        ssl_context.options |= ssl.OP_NO_TLSv1_1

        # Set minimum TLS version to 1.2
        ssl_context.minimum_version = ssl.TLSVersion.TLSv1_2

        # Configure adapter
        adapter = HTTPAdapter()
        self.session.mount('https://', adapter)

        # Verify certificate
        self.session.verify = True

    def verify_connection_security(self):
        &quot;&quot;&quot;Verify TLS connection security&quot;&quot;&quot;
        try:
            response = self.session.get(f&quot;{self.base_url}/Sag?$top=1&quot;)

            # Check response headers for security info
            connection_info = {
                'status_code': response.status_code,
                'url': response.url,
                'headers': dict(response.headers),
                'tls_verified': response.url.startswith('https://'),
                'certificate_valid': True  # If no SSL error occurred
            }

            return connection_info
        except requests.exceptions.SSLError as e:
            return {'error': f'TLS verification failed: {e}'}

    def get_with_security_check(self, endpoint, params=None):
        &quot;&quot;&quot;Make API request with security validation&quot;&quot;&quot;
        try:
            response = self.session.get(
                f&quot;{self.base_url}/{endpoint}&quot;,
                params=params,
                timeout=30  # Prevent hanging connections
            )
            response.raise_for_status()
            return response.json()
        except requests.exceptions.SSLError as e:
            raise SecurityError(f&quot;TLS security check failed: {e}&quot;)
        except requests.exceptions.RequestException as e:
            raise APIError(f&quot;Request failed: {e}&quot;)

# Usage example
client = SecureDanishParliamentClient()
security_status = client.verify_connection_security()
print(f&quot;Connection security: {security_status}&quot;)
</code></pre>
<h3 id="javascriptnodejs-implementation">JavaScript/Node.js Implementation</h3>
<pre><code class="language-javascript">const https = require('https');
const crypto = require('crypto');

class SecureDanishParliamentClient {
    constructor() {
        this.baseURL = 'https://oda.ft.dk/api';
        this.httpsAgent = this.createSecureAgent();
    }

    createSecureAgent() {
        return new https.Agent({
            // Enforce TLS 1.2+
            secureProtocol: 'TLSv1_2_method',

            // Certificate verification
            checkServerIdentity: (host, cert) =&gt; {
                if (host !== 'oda.ft.dk') {
                    throw new Error('Invalid hostname in certificate');
                }

                // Verify certificate chain
                const now = new Date();
                const notAfter = new Date(cert.valid_to);
                if (now &gt; notAfter) {
                    throw new Error('Certificate has expired');
                }

                return undefined; // Certificate is valid
            },

            // Cipher suite restrictions
            ciphers: [
                'ECDHE-RSA-AES256-GCM-SHA384',
                'ECDHE-RSA-AES256-SHA384',
                'ECDHE-RSA-AES128-GCM-SHA256'
            ].join(':'),

            // Security options
            honorCipherOrder: true,
            rejectUnauthorized: true
        });
    }

    async makeSecureRequest(endpoint, params = {}) {
        const url = new URL(endpoint, this.baseURL);
        Object.entries(params).forEach(([key, value]) =&gt; {
            url.searchParams.append(key, value);
        });

        return new Promise((resolve, reject) =&gt; {
            const options = {
                agent: this.httpsAgent,
                headers: {
                    'User-Agent': 'Danish-Parliament-Client/1.0',
                    'Accept': 'application/json'
                }
            };

            https.get(url, options, (response) =&gt; {
                let data = '';

                response.on('data', chunk =&gt; data += chunk);
                response.on('end', () =&gt; {
                    if (response.statusCode === 200) {
                        try {
                            resolve(JSON.parse(data));
                        } catch (e) {
                            reject(new Error('Invalid JSON response'));
                        }
                    } else {
                        reject(new Error(`HTTP ${response.statusCode}`));
                    }
                });
            }).on('error', (error) =&gt; {
                if (error.code === 'CERT_UNTRUSTED') {
                    reject(new Error('Certificate trust verification failed'));
                } else if (error.code === 'EPROTO') {
                    reject(new Error('TLS protocol error'));
                } else {
                    reject(error);
                }
            });
        });
    }

    async verifyCertificate() {
        return new Promise((resolve, reject) =&gt; {
            const options = {
                host: 'oda.ft.dk',
                port: 443,
                agent: this.httpsAgent
            };

            const socket = crypto.connect(options, () =&gt; {
                const cert = socket.getPeerCertificate(true);
                const result = {
                    subject: cert.subject,
                    issuer: cert.issuer,
                    valid_from: cert.valid_from,
                    valid_to: cert.valid_to,
                    fingerprint: cert.fingerprint,
                    serialNumber: cert.serialNumber,
                    is_valid: socket.authorized
                };
                socket.end();
                resolve(result);
            });

            socket.on('error', reject);
        });
    }
}

// Usage
const client = new SecureDanishParliamentClient();

// Verify certificate before making requests
client.verifyCertificate()
    .then(cert =&gt; {
        console.log('Certificate verified:', cert);
        return client.makeSecureRequest('Sag', {'$top': '5'});
    })
    .then(data =&gt; console.log('API data:', data))
    .catch(error =&gt; console.error('Security error:', error));
</code></pre>
<h3 id="browser-implementation">Browser Implementation</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;Content-Security-Policy&quot; 
          content=&quot;default-src 'self' https://oda.ft.dk; 
                   img-src 'self' data: https:; 
                   style-src 'self' 'unsafe-inline';&quot;&gt;
    &lt;title&gt;Secure Danish Parliament API Client&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;script&gt;
        class BrowserSecureClient {
            constructor() {
                this.baseURL = 'https://oda.ft.dk/api';
            }

            async makeSecureRequest(endpoint, params = {}) {
                const url = new URL(endpoint, this.baseURL);
                Object.entries(params).forEach(([key, value]) =&gt; {
                    url.searchParams.append(key, value);
                });

                try {
                    const response = await fetch(url, {
                        method: 'GET',
                        mode: 'cors',
                        credentials: 'omit', // No credentials needed
                        headers: {
                            'Accept': 'application/json',
                            'Cache-Control': 'no-cache'
                        },
                        // Browser automatically handles TLS
                        redirect: 'follow'
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }

                    // Verify we're still on HTTPS
                    if (!response.url.startsWith('https://')) {
                        throw new Error('Response was not served over HTTPS');
                    }

                    return await response.json();
                } catch (error) {
                    console.error('Secure request failed:', error);
                    throw error;
                }
            }

            checkConnectionSecurity() {
                return {
                    protocol: location.protocol,
                    is_secure: location.protocol === 'https:',
                    mixed_content_blocked: !window.isSecureContext,
                    tls_version: 'Managed by browser'
                };
            }
        }

        // Initialize secure client
        const client = new BrowserSecureClient();

        // Check security status
        console.log('Connection security:', client.checkConnectionSecurity());

        // Make secure API request
        client.makeSecureRequest('Sag', {'$top': '3'})
            .then(data =&gt; console.log('Secure API response:', data))
            .catch(error =&gt; console.error('Security error:', error));
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="certificate-management">Certificate Management</h2>
<h3 id="monitoring-certificate-expiry">Monitoring Certificate Expiry</h3>
<pre><code class="language-python">import ssl
import socket
from datetime import datetime

def check_certificate_expiry(hostname='oda.ft.dk', port=443):
    &quot;&quot;&quot;Monitor certificate expiry&quot;&quot;&quot;
    context = ssl.create_default_context()

    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            cert = ssock.getpeercert()

            # Parse expiry date
            expiry_date = datetime.strptime(cert['notAfter'], '%b %d %H:%M:%S %Y %Z')
            days_until_expiry = (expiry_date - datetime.now()).days

            return {
                'certificate_subject': cert['subject'],
                'issuer': cert['issuer'],
                'expires': expiry_date.isoformat(),
                'days_until_expiry': days_until_expiry,
                'is_valid': days_until_expiry &gt; 0
            }

# Example monitoring
cert_status = check_certificate_expiry()
print(f&quot;Certificate expires in {cert_status['days_until_expiry']} days&quot;)

if cert_status['days_until_expiry'] &lt; 30:
    print(&quot;WARNING: Certificate expires soon!&quot;)
</code></pre>
<h3 id="certificate-pinning-advanced">Certificate Pinning (Advanced)</h3>
<pre><code class="language-python">import hashlib
import ssl

# Expected certificate fingerprints (update when certificates change)
EXPECTED_CERT_FINGERPRINTS = [
    'sha256:expected_fingerprint_here'  # Update with actual fingerprint
]

def verify_certificate_pin(hostname='oda.ft.dk', port=443):
    &quot;&quot;&quot;Verify certificate against known fingerprints&quot;&quot;&quot;
    context = ssl.create_default_context()

    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            cert_der = ssock.getpeercert_chain()[0].encode('DER')
            cert_fingerprint = hashlib.sha256(cert_der).hexdigest()

            if f&quot;sha256:{cert_fingerprint}&quot; in EXPECTED_CERT_FINGERPRINTS:
                return True
            else:
                raise SecurityError(f&quot;Certificate fingerprint mismatch: {cert_fingerprint}&quot;)
</code></pre>
<h2 id="troubleshooting-tls-issues">Troubleshooting TLS Issues</h2>
<h3 id="common-tls-problems">Common TLS Problems</h3>
<h4 id="1-certificate-verification-errors">1. Certificate Verification Errors</h4>
<pre><code class="language-python"># Problem: Certificate verification fails
# Solution: Update certificate store or check system time

import certifi
import requests

# Use latest certificate bundle
response = requests.get(
    'https://oda.ft.dk/api/Sag',
    verify=certifi.where()
)
</code></pre>
<h4 id="2-tls-version-mismatches">2. TLS Version Mismatches</h4>
<pre><code class="language-python"># Problem: Client using outdated TLS version
# Solution: Explicitly configure TLS 1.2+

import ssl
import urllib3

# Disable warnings for testing only
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Create context with specific TLS version
context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
context.minimum_version = ssl.TLSVersion.TLSv1_2
</code></pre>
<h4 id="3-cipher-suite-compatibility">3. Cipher Suite Compatibility</h4>
<pre><code class="language-bash"># Test supported cipher suites
openssl s_client -connect oda.ft.dk:443 -cipher 'ECDHE-RSA-AES256-SHA384'

# Expected output should include:
# Cipher    : ECDHE-RSA-AES256-SHA384
# Verification: OK
</code></pre>
<h3 id="diagnostic-commands">Diagnostic Commands</h3>
<pre><code class="language-bash"># Comprehensive TLS analysis
curl -I -v &quot;https://oda.ft.dk/api/Sag&quot; 2&gt;&amp;1 | grep -E &quot;(TLS|SSL|Certificate|Cipher)&quot;

# Test specific TLS version
openssl s_client -connect oda.ft.dk:443 -tls1_2

# Certificate chain analysis
openssl s_client -connect oda.ft.dk:443 -showcerts &lt; /dev/null

# Check certificate expiry
openssl s_client -connect oda.ft.dk:443 &lt; /dev/null 2&gt;/dev/null | openssl x509 -noout -dates
</code></pre>
<h2 id="best-practices-summary">Best Practices Summary</h2>
<h3 id="security-requirements">Security Requirements</h3>
<ol>
<li><strong>Always use HTTPS</strong>: Never make API requests over HTTP</li>
<li><strong>Verify certificates</strong>: Enable certificate verification in all clients</li>
<li><strong>Use TLS 1.2+</strong>: Disable older protocol versions</li>
<li><strong>Monitor expiry</strong>: Track certificate expiration dates</li>
<li><strong>Handle errors</strong>: Properly handle TLS-related exceptions</li>
</ol>
<h3 id="performance-considerations">Performance Considerations</h3>
<ol>
<li><strong>Connection pooling</strong>: Reuse TLS connections when possible</li>
<li><strong>Timeout settings</strong>: Set appropriate connection timeouts</li>
<li><strong>Certificate caching</strong>: Cache certificate validation results</li>
<li><strong>HTTP/1.1 limitation</strong>: API doesn't support HTTP/2, optimize accordingly</li>
</ol>
<h3 id="compliance-integration">Compliance Integration</h3>
<ul>
<li><strong>GDPR</strong>: Ensure encrypted data transmission for personal information</li>
<li><strong>Data Quality</strong>: Verify data integrity through secure connections</li>
<li><strong>Monitoring</strong>: Log TLS-related security events</li>
</ul>
<p>The Danish Parliament API's TLS implementation provides strong encryption for data in transit. While it lacks some modern features like HTTP/2 and security headers, the core TLS configuration is robust and suitable for production use.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
